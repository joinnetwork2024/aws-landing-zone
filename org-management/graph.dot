digraph G {
  rankdir = "RL";
  node [shape = rect, fontname = "sans-serif"];
  "aws_cloudtrail.organization_trail" [label="aws_cloudtrail.organization_trail"];
  "aws_cloudwatch_log_group.cloudtrail_log_group" [label="aws_cloudwatch_log_group.cloudtrail_log_group"];
  "aws_iam_role.cloudtrail_cloudwatch_role" [label="aws_iam_role.cloudtrail_cloudwatch_role"];
  "aws_iam_role_policy.cloudtrail_cloudwatch_policy" [label="aws_iam_role_policy.cloudtrail_cloudwatch_policy"];
  "aws_kms_key.cloudtrail_kms_key" [label="aws_kms_key.cloudtrail_kms_key"];
  "aws_kms_key.s3" [label="aws_kms_key.s3"];
  "aws_organizations_account.dev" [label="aws_organizations_account.dev"];
  "aws_organizations_account.log_archive" [label="aws_organizations_account.log_archive"];
  "aws_organizations_account.network" [label="aws_organizations_account.network"];
  "aws_organizations_account.prod" [label="aws_organizations_account.prod"];
  "aws_organizations_account.staging" [label="aws_organizations_account.staging"];
  "aws_organizations_organization.main" [label="aws_organizations_organization.main"];
  "aws_organizations_organizational_unit.network_ou" [label="aws_organizations_organizational_unit.network_ou"];
  "aws_organizations_organizational_unit.security_ou" [label="aws_organizations_organizational_unit.security_ou"];
  "aws_organizations_organizational_unit.workloads_ou" [label="aws_organizations_organizational_unit.workloads_ou"];
  "aws_organizations_policy.baseline_security_guardrails" [label="aws_organizations_policy.baseline_security_guardrails"];
  "aws_organizations_policy.restrict_regions_scp" [label="aws_organizations_policy.restrict_regions_scp"];
  "aws_organizations_policy_attachment.baseline_workloads" [label="aws_organizations_policy_attachment.baseline_workloads"];
  "aws_organizations_policy_attachment.workloads_region_restriction" [label="aws_organizations_policy_attachment.workloads_region_restriction"];
  "aws_s3_bucket.cloudtrail_logs" [label="aws_s3_bucket.cloudtrail_logs"];
  "aws_s3_bucket.tf_state" [label="aws_s3_bucket.tf_state"];
  "aws_s3_bucket_policy.cloudtrail_bucket_policy" [label="aws_s3_bucket_policy.cloudtrail_bucket_policy"];
  "aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs" [label="aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs"];
  "aws_s3_bucket_server_side_encryption_configuration.tf_state" [label="aws_s3_bucket_server_side_encryption_configuration.tf_state"];
  "aws_s3_bucket_versioning.tf_state_versioning" [label="aws_s3_bucket_versioning.tf_state_versioning"];
  subgraph "cluster_module.scp_guardrails" {
    label = "module.scp_guardrails"
    fontname = "sans-serif"
    "module.scp_guardrails.aws_organizations_policy.deny_regions" [label="aws_organizations_policy.deny_regions"];
  }
  "aws_cloudtrail.organization_trail" -> "aws_cloudwatch_log_group.cloudtrail_log_group";
  "aws_cloudtrail.organization_trail" -> "aws_iam_role.cloudtrail_cloudwatch_role";
  "aws_cloudtrail.organization_trail" -> "aws_kms_key.cloudtrail_kms_key";
  "aws_cloudtrail.organization_trail" -> "aws_s3_bucket_policy.cloudtrail_bucket_policy";
  "aws_iam_role_policy.cloudtrail_cloudwatch_policy" -> "aws_cloudwatch_log_group.cloudtrail_log_group";
  "aws_iam_role_policy.cloudtrail_cloudwatch_policy" -> "aws_iam_role.cloudtrail_cloudwatch_role";
  "aws_kms_key.cloudtrail_kms_key" -> "aws_organizations_account.log_archive";
  "aws_organizations_account.dev" -> "aws_organizations_organizational_unit.workloads_ou";
  "aws_organizations_account.log_archive" -> "aws_organizations_organizational_unit.security_ou";
  "aws_organizations_account.network" -> "aws_organizations_organizational_unit.network_ou";
  "aws_organizations_account.prod" -> "aws_organizations_organizational_unit.workloads_ou";
  "aws_organizations_account.staging" -> "aws_organizations_organizational_unit.workloads_ou";
  "aws_organizations_organizational_unit.network_ou" -> "aws_organizations_organization.main";
  "aws_organizations_organizational_unit.security_ou" -> "aws_organizations_organization.main";
  "aws_organizations_organizational_unit.workloads_ou" -> "aws_organizations_organization.main";
  "aws_organizations_policy_attachment.baseline_workloads" -> "aws_organizations_organizational_unit.workloads_ou";
  "aws_organizations_policy_attachment.baseline_workloads" -> "aws_organizations_policy.baseline_security_guardrails";
  "aws_organizations_policy_attachment.workloads_region_restriction" -> "aws_organizations_organizational_unit.workloads_ou";
  "aws_organizations_policy_attachment.workloads_region_restriction" -> "aws_organizations_policy.restrict_regions_scp";
  "aws_s3_bucket.cloudtrail_logs" -> "aws_organizations_account.log_archive";
  "aws_s3_bucket_policy.cloudtrail_bucket_policy" -> "aws_s3_bucket.cloudtrail_logs";
  "aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs" -> "aws_kms_key.s3";
  "aws_s3_bucket_server_side_encryption_configuration.cloudtrail_logs" -> "aws_s3_bucket.cloudtrail_logs";
  "aws_s3_bucket_server_side_encryption_configuration.tf_state" -> "aws_kms_key.s3";
  "aws_s3_bucket_server_side_encryption_configuration.tf_state" -> "aws_s3_bucket.tf_state";
  "aws_s3_bucket_versioning.tf_state_versioning" -> "aws_s3_bucket.tf_state";
}
